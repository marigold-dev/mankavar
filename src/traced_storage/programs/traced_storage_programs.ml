(*****************************************************************************)
(*                                                                           *)
(* Open Source License                                                       *)
(* Copyright (c) 2021 Marigold <gabriel.alfour@gmail.com>                    *)
(* Copyright (c) 2021 Nomadic Labs. <contact@nomadic-labs.com>               *)
(*                                                                           *)
(* Permission is hereby granted, free of charge, to any person obtaining a   *)
(* copy of this software and associated documentation files (the "Software"),*)
(* to deal in the Software without restriction, including without limitation *)
(* the rights to use, copy, modify, merge, publish, distribute, sublicense,  *)
(* and/or sell copies of the Software, and to permit persons to whom the     *)
(* Software is furnished to do so, subject to the following conditions:      *)
(*                                                                           *)
(* The above copyright notice and this permission notice shall be included   *)
(* in all copies or substantial portions of the Software.                    *)
(*                                                                           *)
(* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR*)
(* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,  *)
(* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL   *)
(* THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER*)
(* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING   *)
(* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER       *)
(* DEALINGS IN THE SOFTWARE.                                                 *)
(*                                                                           *)
(*****************************************************************************)

open Traced_storage.Sparse
include Types
module Generators = Generators

let g s = Get (make_key s)

let s k v = Set (make_key k, Bytes.of_string v)

let sx k vx = Set (make_key k, hex_to_bytes vx)

let m k = Mem (make_key k)

let setup_program : program -> Patricia_produce_stream_impl.tree =
 fun p ->
  let open Patricia in
  let aux : Tree.t -> instruction -> Tree.t =
   fun t i -> match i with Get _ -> t | Set (k, v) -> set t k v | Mem _ -> t
  in
  let st = List.fold_left aux empty p in
  Patricia_produce_stream_impl.of_tree st

module Dev = struct
  let key_a = [true; true]

  let key_b = [false; false]

  let key_c = [false; true; false; false]

  let key_d = [false; true; false; false; true; true]

  let key_e = [true; false; true; false]

  let value_x = Bytes.of_string "foo"

  let value_y = Bytes.of_string "bar"

  let value_z = Bytes.of_string "42"

  let value_w = Bytes.of_string "wooo"
end

let program_a =
  let open Dev in
  let setup : program = [Set (key_a, value_x); Set (key_c, value_z)] in
  let trial : program = [Get key_a; Set (key_b, value_y); Get key_c] in
  ("program_a", setup, trial, true)

let program_b =
  let setup : program =
    [s "11" "foo"; s "0100" "42"; s "11" "wee"; s "10" "wot"]
  in
  let trial : program =
    [g "11"; s "00" "bar"; g "0100"; s "11" "wet"; s "11" "woot"; g "11"]
  in
  ("program_b", setup, trial, true)

let program_c =
  let setup : program = [] in
  let trial : program = [g "00"] in
  ("program_c", setup, trial, true)

let program_d =
  let setup : program = [] in
  let trial : program = [s "000" "wee"; g "00"] in
  ("program_d", setup, trial, false)

let program_e =
  let setup : program = [s "00" "woo"] in
  let trial : program = [g "000"] in
  ("program_e", setup, trial, false)

let program_f =
  let setup : program = [] in
  let trial : program = [g "0"; g "1"] in
  ("program_f", setup, trial, true)

let program_g =
  let setup : program = [] in
  let trial : program =
    [
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      g
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010";
      sx
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010"
        "0x00000001";
      sx
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111"
        "0x00000000";
      sx
        "01101001011001000010110101110011011010010110011101101110011001010111001000000000000000000000000000000000"
        "0x0000006015fa3538b8379ff2423656ab436df1632b74311aaef49bc9a3cbd70b1b01febaf2f869b4127d0e8e6d18d7d919f1f6d8052ef3ec82ebff7065eeffbe4200013d4f054d2722c3dbe21e903d9e563b7e6514b29b9e3c696ce64d89c705e488aea7";
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      sx
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111"
        "0x01";
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      g
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010";
      g
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010";
      sx
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010"
        "0x00000002";
      sx
        "011100000110101100101101011010010110010000000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001"
        "0x00000001";
      sx
        "01101001011001000010110101110011011010010110011101101110011001010111001000000000000000000000000000000001"
        "0x000000600f81b19ee2e4d4d0ff6384c63bacb785bc05c4fc22e6f553079cc4ff7e0270d458951533458a01d160b22d59a8bd9ab50b3b5f8d63b2d39bb00769d6859dcd8ed3cbbc4a02d783863819e32fbac56217753e35dcd591049258c7a12e4be92101";
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      sx
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001"
        "0x01";
      g
        "0111001001101111011011000110110001110101011100000010110101100011011011110111010101101110011101000110010101110010";
      g
        "0111001001101111011011000110110001110101011100000010110101100011011011110111010101101110011101000110010101110010";
      sx
        "0111001001101111011011000110110001110101011100000010110101100011011011110111010101101110011101000110010101110010"
        "0x3432";
      g
        "0111001001101111011011000110110001110101011100000010110101100011011011110111010101101110011101000110010101110010";
      g
        "0111001001101111011011000110110001110101011100000010110101100011011011110111010101101110011101000110010101110010";
      sx
        "0111001001101111011011000110110001110101011100000010110101100011011011110111010101101110011101000110010101110010"
        "0x3139";
    ]
  in
  ("program_g", setup, trial, true)

let program_h =
  let setup : program = [] in
  let trial : program =
    [
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
    ]
  in
  ("program_h", setup, trial, true)

let program_i =
  let setup : program =
    [
      s
        "00110000"
        "0x0000006015fa3538b8379ff2423656ab436df1632b74311aaef49bc9a3cbd70b1b01febaf2f869b4127d0e8e6d18d7d919f1f6d8052ef3ec82ebff7065eeffbe4200013d4f054d2722c3dbe21e903d9e563b7e6514b29b9e3c696ce64d89c705e488aea780897a0000";
      s
        "01101110011001010111100001110100010111110110100101101110011001000110010101111000"
        "0x31";
    ]
  in
  let trial : program =
    [
      (* produce *)
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      (* produce *)
      g
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010";
      (* produce *)
      sx
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010"
        "0x00000001";
      (* produce *)
      sx
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111"
        "0x00000000";
      (* produce *)
      sx
        "01101001011001000010110101110011011010010110011101101110011001010111001000000000000000000000000000000000"
        "0x0000006015fa3538b8379ff2423656ab436df1632b74311aaef49bc9a3cbd70b1b01febaf2f869b4127d0e8e6d18d7d919f1f6d8052ef3ec82ebff7065eeffbe4200013d4f054d2722c3dbe21e903d9e563b7e6514b29b9e3c696ce64d89c705e488aea7";
      (* produce *)
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      (* produce *)
      sx
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111"
        "0x01";
      (* produce *)
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      (* produce *)
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      (* produce *)
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      (* produce *)
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111";
      (* produce *)
      sx
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000101011111101000110101001110001011100000110111100111111111001001000010001101100101011010101011010000110110110111110001011000110010101101110100001100010001101010101110111101001001101111001001101000111100101111010111000010110001101100000001111111101011101011110010111110000110100110110100000100100111110100001110100011100110110100011000110101111101100100011001111100011111011011011000000001010010111011110011111011001000001011101011111111110111000001100101111011101111111110111110010000100000000000000001001111010100111100000101010011010010011100100010110000111101101111100010000111101001000000111101100111100101011000111011011111100110010100010100101100101001101110011110001111000110100101101100111001100100110110001001110001110000010111100100100010001010111010100111"
        "0x02";
      (* produce *)
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      (* produce *)
      g
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010";
      (* produce *)
      g
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010";
      (* produce *)
      sx
        "0111001101101001011001110110111001100101011100100010110101100011011011110111010101101110011101000110010101110010"
        "0x00000002";
      (* produce *)
      sx
        "011100000110101100101101011010010110010000000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001"
        "0x00000001";
      (* produce *)
      sx
        "01101001011001000010110101110011011010010110011101101110011001010111001000000000000000000000000000000001"
        "0x000000600f81b19ee2e4d4d0ff6384c63bacb785bc05c4fc22e6f553079cc4ff7e0270d458951533458a01d160b22d59a8bd9ab50b3b5f8d63b2d39bb00769d6859dcd8ed3cbbc4a02d783863819e32fbac56217753e35dcd591049258c7a12e4be92101";
      (* produce *)
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      (* produce *)
      sx
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001"
        "0x01";
      (* produce *)
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      (* produce *)
      g
        "011100000110101100101101011010010110010000000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      (* produce *)
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      (* produce *)
      g
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001";
      (* produce *)
      sx
        "01110010011001010111000001101100011000010111100100000000000000000000000001100000000011111000000110110001100111101110001011100100110101001101000011111111011000111000010011000110001110111010110010110111100001011011110000000101110001001111110000100010111001101111010101010011000001111001110011000100111111110111111000000010011100001101010001011000100101010001010100110011010001011000101000000001110100010110000010110010001011010101100110101000101111011001101010110101000010110011101101011111100011010110001110110010110100111001101110110000000001110110100111010110100001011001110111001101100011101101001111001011101111000100101000000010110101111000001110000110001110000001100111100011001011111011101011000101011000100001011101110101001111100011010111011100110101011001000100000100100100100101100011000111101000010010111001001011111010010010000100000001"
        "0x02";
      (* produce *)
      g "00110001";
      (* produce *)
      g "00110001";
      (* produce *)
      g "00110010";
      (* produce *)
      g "00110010";
    ]
  in
  ("program_i", setup, trial, true)

let program_j =
  let setup : program = [sx "01" "0xee"] in
  let trial : program = [g "0"] in
  ("program_j", setup, trial, false)

let program_k =
  let setup : program = [s "1" "foo"] in
  let trial : program = [s "11" "bar"] in
  ("program_k", setup, trial, false)

let program_m =
  let setup : program =
    [
      s
        "01101110011001010111100001110100010111110110100101101110011001000110010101111000"
        "0x31";
    ]
  in
  let trial : program =
    [
      g
        "01101110011001010111100001110100010111110110100101101110011001000110010101111000";
    ]
  in
  ("program_m", setup, trial, true)

let program_n =
  let setup : program = [s "1010" "a"; s "1011" "b"] in
  let trial : program =
    [
      s "11000101010000" "c";
      m "1110011010101";
      m
        "1011001001011100010001111001001000000000010111000100000010000010000111001110111011011";
      m "1010";
      s "101111101" "d";
      g "11010111";
      g "100000010101110";
    ]
  in
  ("program_n", setup, trial, false)

let programs =
  [
    program_a;
    program_b;
    program_c;
    program_d;
    program_e;
    program_f;
    program_g;
    program_h;
    program_i;
    program_j;
    program_k;
    program_m;
    program_n;
  ]
